<?xml version="1.0" encoding="utf-8" ?>
<ContentPage xmlns="http://schemas.microsoft.com/dotnet/2021/maui"  
             xmlns:x="http://schemas.microsoft.com/winfx/2009/xaml" 
             xmlns:toolkit="http://schemas.microsoft.com/dotnet/2022/maui/toolkit"
             x:Class="Conda_AI.View.TasksListsPage"  
             Title="TasksListsPage"  
             x:Name="TasksPage">  
    <VerticalStackLayout Padding="18" Spacing="14">  
        <!--Header with +-->  
        <Grid ColumnDefinitions="*,Auto">  
            <Label Text="To-Do's"  Style="{StaticResource HeaderLabel}"/>  
            <Button Text="+"    
                FontSize="24"    
                WidthRequest="40"    
                HeightRequest="40"    
                CornerRadius="40"    
                TextColor="Black"    
                FontAttributes="Bold"    
                BackgroundColor="LightGray"    
                HorizontalOptions="End"    
                VerticalOptions="Center"  
                Command="{Binding AddTaskCommand}"/>  
        </Grid>  
        <!--Category Selection-->  
        <Grid ColumnDefinitions="100,*,*">  
            <Label Grid.Column="0"  Text="Sortiert nach:"  FontSize="12" VerticalOptions="End" Margin="8"/>  
            <Picker Grid.Column="1"    
                Title="Kategorie wählen"    
                ItemsSource="{Binding Categories}"    
                SelectedItem="{Binding SelectedCategory, Mode=TwoWay}"/>  
            <Picker Grid.Column="2"    
                Title="Attribut wählen"    
                ItemsSource="{Binding Attribute}"    
                SelectedItem="{Binding SelectedAttribute, Mode=TwoWay}"/>  
        </Grid>  
          
        <!--To-Do's-->  
        <!-- Aufgabenliste -->  
        <Grid RowDefinitions="Auto" Margin="0,10,0,0">  
            <CollectionView Grid.Row="1"   
                ItemsSource="{Binding FilteredTasks}"   
                VerticalOptions="Fill"    
                HorizontalOptions="Fill">  
                <!--Tasks nach Tests in TaskModel umwandeln muss-->  
  
                <CollectionView.ItemTemplate>  
                    <DataTemplate>  
                        <Border IsVisible="{Binding IsVisible}"  
                                Padding="8"   
                                BackgroundColor="#F5F5F5"    
                                StrokeShape="RoundRectangle 10">

                            <Grid RowDefinitions="Auto,Auto"    
                                  ColumnDefinitions="40,*,*,60">
                                <CheckBox
                                          Grid.RowSpan="2"  
                                          Grid.Column="0"
                                          VerticalOptions="Center"  
                                          HorizontalOptions="Start"  
                                          IsChecked="{Binding Status, Converter={StaticResource StatusToBoolConverter}, Mode=TwoWay}">
                                    <CheckBox.Behaviors>
                                        <toolkit:EventToCommandBehavior
                                            EventName="CheckedChanged"
                                            Command="{Binding Source={x:Reference TasksPage}, Path=BindingContext.UpdateTaskStatusCommand}"
                                            CommandParameter="{Binding .}"
                                            />
                                    </CheckBox.Behaviors>
                                </CheckBox>
                                <Label Text="{Binding Name}"    
                                       TextDecorations="Underline"   
                                       FontSize="18"    
                                       Grid.Row="0"    
                                       Grid.Column="1"    
                                       VerticalOptions="Center"    
                                       HorizontalOptions="Center"/>  
  
                                <Label   
                                       Text="{Binding Priority, StringFormat='Priorität: {0}'}"    
                                       FontSize="10"    
                                       Grid.Row="0"    
                                       Grid.Column="2"    
                                       VerticalOptions="Center"    
                                       HorizontalOptions="Start"/>  
  
                                <Grid Grid.Column="1"    
                                      Grid.Row="1"  
                                      RowDefinitions="*,*"  
                                      ColumnDefinitions="60,*">  
  
                                    <Label Text="Kategorie: "   
                                             FontSize="10"  
                                             HorizontalOptions="End"   
                                             VerticalOptions="Center"/>  
  
                                    <Label Text="{Binding Category}"    
                                             Grid.Column="1"  
                                             FontSize="10"  
                                             HorizontalTextAlignment="Center"  
                                             VerticalOptions="Center"/>  
  
                                    <Label Text="Ort: "   
                                             HorizontalOptions="End"   
                                             Grid.Row="1"   
                                             VerticalOptions="Center"   
                                             FontSize="10"/>  
  
                                    <Label Text="{Binding Location}"    
                                             Grid.Column="1"  
                                             Grid.Row="1"  
                                             FontSize="10"    
                                             HorizontalTextAlignment="Center"  
                                             VerticalOptions="Center"/>  
                                </Grid>  
  
                                <Grid Grid.Column="2"    
                                      Grid.Row="1"  
                                      RowDefinitions="*,*"  
                                      ColumnDefinitions="60,*">  
  
                                    <Label Text="Deadline: "   
                                             FontSize="10"  
                                             HorizontalOptions="End"   
                                             VerticalOptions="Center"/>  
  
                                    <Label Text="{Binding DueDate, StringFormat='{} {0:ddd dd.MM.yy}'}"    
                                             Grid.Column="1"  
                                             FontSize="10"  
                                             HorizontalTextAlignment="Center"  
                                             VerticalOptions="Center"/>  
  
                                    <Label Text="Aufwand: "   
                                             HorizontalOptions="End"   
                                             Grid.Row="1"   
                                             VerticalOptions="Center"   
                                             FontSize="10"/>  
  
                                    <Label Text="{Binding EstimatedEffort, StringFormat='{0}h'}"    
                                             Grid.Column="1"  
                                             Grid.Row="1"  
                                             FontSize="10"    
                                             HorizontalTextAlignment="Center"  
                                             VerticalOptions="Center"/>  
                                </Grid>  
  
                                <Button   
                                        Grid.Column="3"  
                                        Grid.RowSpan="2"  
                                        FontSize="15"  
                                        BackgroundColor="LightGray"  
                                        Margin="6"  
                                        Text="✎"  
                                        Command="{Binding BindingContext.GoToTaskPageCommand, Source={x:Reference Name=TasksPage}}"  
                                        CommandParameter="{Binding .}"/>  
                            </Grid>  
                        </Border>  
                    </DataTemplate>  
                </CollectionView.ItemTemplate>  
            </CollectionView>  
        </Grid>  
    </VerticalStackLayout>  
</ContentPage>